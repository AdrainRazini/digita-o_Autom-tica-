<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de VBS</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
        }
        #texto {
            font-size: 20px;
            width: 80%;
            margin: auto;
            white-space: pre-line;
            min-height: 100px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
        }
        textarea {
            width: 80%;
            padding: 10px;
            font-size: 16px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<h1>
    O formato que eu vi que é aceito é esse aqui
</h1>

<p>
    O dia amanheceu claro, e a brisa suave acariciava as folhas das árvores. Na praça central, as pessoas começavam a se reunir para o evento que aconteceria mais tarde. A excitação estava no ar, e todos esperavam ansiosamente pelo momento em que o grande anúncio seria feito.

“Será que finalmente teremos boas notícias?” alguém comentou, enquanto caminhava entre os grupos de amigos. “Espero que sim. A cidade precisa de algo que nos traga esperança.”

A tensão era palpável, e, ao longe, podia-se ouvir o som da música começando a tocar. O evento estava prestes a começar, e todos estavam prontos para ouvir o que o futuro reservava.

De repente, o palco foi iluminado e uma figura conhecida subiu ao microfone. O público silenciou, esperando ansiosamente as palavras que estavam por vir.

“Bem-vindos! Hoje é um dia histórico para nossa cidade. Juntos, vamos iniciar uma nova fase que trará mudanças significativas para todos nós!”, anunciou com um sorriso confiante.

</p>

    <h1>Gerador de VBS</h1>
    <textarea id="userText" placeholder="Digite seu texto aqui..." rows="10"></textarea>
    <br>
    <button onclick="generateVBS()">Gerar VBS</button>

    <script>
        // Função para remover acentos
        function removeAccents(str) {
            return str
                .replace(/[áàãâä]/g, 'a')
                .replace(/[éèêë]/g, 'e')
                .replace(/[íìîï]/g, 'i')
                .replace(/[óòõôö]/g, 'o')
                .replace(/[úùûü]/g, 'u')
                .replace(/[ç]/g, 'c')
                .replace(/[ÁÀÃÂÄ]/g, 'A')
                .replace(/[ÉÈÊË]/g, 'E')
                .replace(/[ÍÌÎÏ]/g, 'I')
                .replace(/[ÓÒÕÔÖ]/g, 'O')
                .replace(/[ÚÙÛÜ]/g, 'U')
                .replace(/[Ç]/g, 'C');
        }

        // Função para gerar o arquivo VBS
        function generateVBS() {
            let userText = document.getElementById("userText").value;

            // Remove acentos do texto
            let cleanedText = removeAccents(userText);

            // Escapa as quebras de linha corretamente
            let formattedText = cleanedText.split("\n").map(function(line) {
                return '"' + line.trim() + '"';
            }).join(' & vbCrLf & _\n');

            // Formatar o código VBS com o texto limpo e as quebras de linha
            let vbsCode = `Set WshShell = CreateObject("WScript.Shell")\nWScript.Sleep 2000 ' Espera 2 segundos antes de comecar a digitar\n\ntexto = ${formattedText}\nWshShell.SendKeys texto\nWshShell.SendKeys "{ENTER}" ' Aperta Enter no final`;

            // Criar o arquivo VBS (no navegador, você cria o arquivo com o conteúdo gerado)
            let blob = new Blob([vbsCode], { type: 'text/vbs' });
            let link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'escrita.vbs'; // Nome do arquivo VBS
            link.click();
        }
    </script>
</body>
</html>
